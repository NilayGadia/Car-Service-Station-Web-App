{"ast":null,"code":"import _regeneratorRuntime from\"/home/sanket/Downloads/Client/Client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/sanket/Downloads/Client/Client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/sanket/Downloads/Client/Client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useDispatch}from'react-redux';import{Link,useHistory}from'react-router-dom';import{toast}from'react-toastify';import{login}from'./features/authSlice';import{loginUser as loginUserApi}from'./services/user';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SignIn(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];// State to store user data\n// get the history object\nvar history=useHistory();// get dispatcher object\nvar dispatch=useDispatch();var loginUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,_response$data,token,_user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(email.length===''||password.length==='')){_context.next=3;break;}toast.error('Please enter both email and password');return _context.abrupt(\"return\");case 3:_context.prev=3;_context.next=6;return loginUserApi(email,password);case 6:response=_context.sent;if(response.status===200){_response$data=response.data,token=_response$data.token,_user=_response$data.user;// Destructure token and user from the response\n// Store token and user data in sessionStorage or localStorage\nsessionStorage.setItem('token',token);sessionStorage.setItem('userId',_user.userId);sessionStorage.setItem('fname',_user.fname);sessionStorage.setItem('lname',_user.lname);sessionStorage.setItem('role',_user.role);sessionStorage.setItem('email',_user.email);// update global store's authSlice with status = true\ndispatch(login());toast.success(\"Welcome \".concat(_user.fname,\" to Garage Masters\"));if(_user.role==='ROLE_ADMIN'){// Assuming outlet information is present in the user object\nsessionStorage.setItem('outletId',_user.outlet?_user.outlet.outletId:null);history.push('/Dashboard');}else{history.push('/Services');}}else{toast.error('Invalid user name or password');}_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);console.error('Error during login:',_context.t0.response.data);toast.error('An error occurred during login');case 14:case\"end\":return _context.stop();}},_callee,null,[[3,10]]);}));return function loginUser(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:'center',margin:10},children:\"Login\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:function onChange(e){setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",onChange:function onChange(e){setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[\"Don't have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/SignUp\",children:\"Register here\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:loginUser,className:\"btn btn-success\",children:\"Login\"})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col\"})]})]});}","map":{"version":3,"names":["useState","useEffect","useDispatch","Link","useHistory","toast","login","loginUser","loginUserApi","jsx","_jsx","jsxs","_jsxs","SignIn","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","_useState6","user","setUser","history","dispatch","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","_response$data","token","_user","wrap","_callee$","_context","prev","next","length","error","abrupt","sent","status","data","sessionStorage","setItem","userId","fname","lname","role","success","concat","outlet","outletId","push","t0","console","stop","apply","arguments","className","children","style","textAlign","margin","htmlFor","type","onChange","e","target","value","to","onClick"],"sources":["/home/sanket/Downloads/Client/Client/src/SignIn.jsx"],"sourcesContent":["import { useState , useEffect } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { Link, useHistory  } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { login } from './features/authSlice';\nimport { loginUser as loginUserApi } from './services/user';\n export default function SignIn()\n{ \n\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [user, setUser] = useState(''); // State to store user data\n\n  // get the history object\n  const history = useHistory()\n\n  // get dispatcher object\n  const dispatch = useDispatch()\n\n  const loginUser = async () => {\n    if (email.length === '' || password.length === '') {\n      toast.error('Please enter both email and password');\n      return;\n    }\n\n    try {\n      // call login API\n      const response = await loginUserApi(email, password);\n\n      if (response.status === 200) {\n        const { token, user } = response.data; // Destructure token and user from the response\n\n        // Store token and user data in sessionStorage or localStorage\n        sessionStorage.setItem('token', token);\n        sessionStorage.setItem('userId', user.userId);\n        sessionStorage.setItem('fname', user.fname);\n        sessionStorage.setItem('lname', user.lname);\n        sessionStorage.setItem('role', user.role);\n        sessionStorage.setItem('email', user.email);\n\n        // update global store's authSlice with status = true\n        dispatch(login());\n\n        toast.success(`Welcome ${user.fname} to Garage Masters`);\n\n        if (user.role === 'ROLE_ADMIN') {\n          // Assuming outlet information is present in the user object\n          sessionStorage.setItem('outletId', user.outlet ? user.outlet.outletId : null);\n          history.push('/Dashboard');\n        } else {\n          history.push('/Services');\n        }\n      } else {\n        toast.error('Invalid user name or password');\n      }\n    } catch (error) {\n      console.error('Error during login:', error.response.data);\n      toast.error('An error occurred during login');\n    }\n  }\n\n    return((\n        <div className=\"container-fluid\" >\n            <br/><br/><br/><br/>\n          <h1 style={{ textAlign: 'center', margin: 10 }}>Login</h1>\n    \n          <div className='row'>\n            <div className='col'></div>\n            <div className='col'>\n              <div className='form'>\n                <div className='mb-3'>\n                  <label htmlFor=''>Email</label>\n                  <input\n                    type='text'\n                    className='form-control'\n                    onChange={(e) => {\n                      setEmail(e.target.value)\n                    }}\n                  />\n                </div>\n                <div className='mb-3'>\n                  <label htmlFor=''>Password</label>\n                  <input\n                    type='password'\n                    className='form-control'\n                    onChange={(e) => {\n                      setPassword(e.target.value)\n                    }}\n                  />\n                </div>\n                <div className='mb-3'>\n                  <div className='mb-3'>\n                    Don't have an account? <Link to='/SignUp'>Register here</Link>\n                  </div>\n                  <button onClick={loginUser} className='btn btn-success'>\n                    Login\n                  </button>\n                </div>\n              </div>\n            </div>\n            <div className='col'></div>\n          </div>\n        </div>\n      )\n    );\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}